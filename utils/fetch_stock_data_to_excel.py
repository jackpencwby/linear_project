dow_jones = ["UNH", "GS", "MSFT", "HD", "CAT", "AMGN", "MCD", "CRM", "V", "AXP", "TRV", "AAPL", "IBM", "JPM", "HON", "AMZN", "PG", "JNJ", "BA", "CVX", "MMM", "MRK", "DIS", "NKE", "WMT", "KO", "DOW", "CSCO", "VZ", "INTC"]
s_and_p_500 = ["AAPL", "MSFT", "NVDA", "AMZN", "META", "GOOGL", "AVGO", "GOOG", "LLY", "TSLA", "JPM", "UNH", "XOM", "V", "PG", "MA", "COST", "HD", "JNJ", "WMT", "ABBV", "NFLX", "MRK", "KO", "AMD", "ORCL", "CRM", "BAC", "CVX", "TMO", "PEP", "LIN", "ADBE", "ACN", "MCD", "CSCO", "IBM", "GE", "ABT", "QCOM", "WFC", "TXN", "CAT", "PM", "VZ", "NOW", "INTU", "DHR", "AMAT", "DIS", "ISRG", "NEE", "AMGN", "PFE", "SPGI", "UBER", "RTX", "CMCSA", "GS", "T", "LOW", "AXP", "UNP", "PGR", "BKNG", "HON", "TJX", "ETN", "BLK", "MS", "SYK", "LMT", "BSX", "MU", "ELV", "VRTX", "COP", "C", "PLD", "ADI", "MDT", "ADP", "BX", "LRCX", "SBUX", "REGN", "MMC", "PANW", "CB", "AMT", "KLAC", "NKE", "DE", "GILD", "FI", "INTC", "BMY", "TMUS", "ANET", "MDLZ", "UPS", "SO", "CI", "SCHW", "ICE", "BA", "SHW", "DUK", "KKR", "ZTS", "TT", "MO", "CL", "EQIX", "PYPL", "PH", "CEG", "CMG", "APH", "SNPS", "CME", "TDG", "GD", "MMM", "AON", "CDNS", "HCA", "WM", "MSI", "PLTR", "FCX", "CVS", "MCO", "WELL", "PNC", "TGT", "NOC", "CTAS", "ITW", "USB", "BDX", "EOG", "ORLY", "CARR", "APD", "CSX", "CRWD", "ECL", "NEM", "EMR", "MCK", "NXPI", "AJG", "FDX", "ROP", "ADSK", "MAR", "SLB", "HLT", "ABNB", "TFC", "COF", "PSA", "AFL", "NSC", "DHI", "PSX", "MPC", "WMB", "AZO", "O", "TRV", "AEP", "URI", "BK", "OKE", "SRE", "GM", "PCAR", "JCI", "SPG", "ROST", "CCI", "DLR", "ALL", "FTNT", "MET", "D", "KMB", "FICO", "AIG", "GWW", "MPWR", "AMP", "CPRT", "TEL", "FIS", "MSCI", "CMI", "LEN", "LHX", "VLO", "PWR", "PEG", "RCL", "MCHP", "PRU", "A", "PAYX", "PCG", "ACGL", "IDXX", "KMI", "F", "OTIS", "GIS", "FAST", "RSG", "IQV", "HWM", "CTVA", "STZ", "EXC", "AME", "IT", "EW", "KDP", "VST", "COR", "IR", "YUM", "CNC", "DOW", "SYY", "CTSH", "VRSK", "HUM", "EXR", "DD", "CBRE", "ODFL", "KR", "MNST", "DELL", "HES", "HPQ", "EFX", "XEL", "ED", "RMD", "NUE", "GLW", "DFS", "BKR", "EA", "VICI", "IRM", "HIG", "OXY", "EIX", "DAL", "VMC", "MLM", "XYL", "AVB", "TRGP", "WAB", "MTD", "ON", "PPG", "EBAY", "LULU", "TSCO", "ROK", "CHTR", "KHC", "CSGP", "CDW", "FANG", "NDAQ", "WEC", "WTW", "NVR", "MTB", "PHM", "FITB", "ADM", "ANSS", "AXON", "BIIB", "HSY", "AWK", "ETR", "KEYS", "FTV", "FSLR", "DXCM", "GRMN", "IFF", "CAH", "DOV", "HPE", "VTR", "STT", "DTE", "NTAP", "SBAC", "EQR", "CHD", "LYB", "GPN", "TTWO", "BR", "TYL", "HAL", "BRO", "TROW", "WY", "PPL", "DECK", "DVN", "ES", "EL", "STE", "STX", "WDC", "HUBB", "AEE", "RJF", "TER", "FE", "WST", "BLDR", "GDDY", "ZBH", "COO", "PTC", "K", "MRNA", "CBOE", "LDOS", "CPAY", "ATO", "HBAN", "WAT", "EQT", "CINF", "MKC", "RF", "CMS", "TDY", "BALL", "SMCI", "OMC", "CLX", "INVH", "DRI", "MOH", "BAX", "GPC", "BBY", "SYF", "ULTA", "J", "UAL", "APTV", "PKG", "ZBRA", "DG", "ARE", "ESS", "CCL", "CNP", "NRG", "HOLX", "MAA", "WBD", "EXPE", "LH", "PFG", "CFG", "MAS", "NTRS", "EXPD", "STLD", "LUV", "AVY", "ALGN", "FDS", "DGX", "LVS", "WRB", "CTRA", "IP", "TSN", "LYV", "EG", "SWK", "PODD", "AMCR", "TXT", "IEX", "PNR", "SWKS", "DOC", "VRSN", "RVTY", "CAG", "KIM", "ENPH", "LNT", "KEY", "CF", "NI", "CE", "SNA", "AKAM", "DPZ", "TRMB", "DLTR", "GEN", "MRO", "JBL", "L", "UHS", "NDSN", "POOL", "EVRG", "ROL", "AES", "VTRS", "JBHT", "BG", "UDR", "ERIE", "EMN", "CPT", "FFIV", "HST", "JNPR", "SJM", "JKHY", "CHRW", "ALLE", "TECH", "KMX", "IPG", "BXP", "REG", "TFX", "EPAM", "ALB", "CTLT", "TPR", "AOS", "LKQ", "INCY", "AIZ", "CRL", "HII", "PNW", "NWSA", "QRVO", "GL", "CPB", "TAP", "MKTX", "MTCH", "LW", "FOXA", "HAS", "DAY", "NCLH", "HRL", "GNRC", "HSIC", "CZR", "MGM", "APA", "FRT", "WYNN", "MOS", "FMC", "MHK", "BWA", "PAYC", "IVZ", "RL", "DVA", "BBWI", "BEN", "PARA", "WBA", "FOX", "NWS"]
nasdaq = ["AAPL", "MSFT", "NVDA", "AVGO", "AMZN", "META", "TSLA", "COST", "GOOGL", "GOOG", "NFLX", "AMD", "TMUS", "PEP", "LIN", "ADBE", "CSCO", "QCOM", "TXN", "INTU", "ISRG", "AMAT", "AMGN", "CMCSA", "BKNG", "HON", "MU", "VRTX", "ADI", "REGN", "ADP", "SBUX", "LRCX", "PANW", "KLAC", "MELI", "GILD", "INTC", "MDLZ", "PDD", "CTAS", "PYPL", "ASML", "CEG", "SNPS", "CDNS", "MAR", "ORLY", "CSX", "CRWD", "MRVL", "NXPI", "ROP", "FTNT", "ADSK", "ABNB", "DASH", "AEP", "WDAY", "PCAR", "ROST", "MNST", "KDP", "CPRT", "TTD", "PAYX", "AZN", "CHTR", "MCHP", "KHC", "IDXX", "ODFL", "FAST", "EXC", "CTSH", "EA", "VRSK", "CCEP", "XEL", "DDOG", "BKR", "LULU", "ON", "CSGP", "CDW", "FANG", "ANSS", "BIIB", "DXCM", "TTWO", "TEAM", "ZS", "MRNA", "SMCI", "GFS", "ILMN", "WBD", "MDB", "DLTR"]

all_stock_index = [
    {"DJIA": dow_jones},
    {"S&P500": s_and_p_500},
    {"NASDAQ": nasdaq}
]

print(f"Dow Jone : {len(dow_jones)}")
print(f"S&P500 : {len(s_and_p_500)}")
print(f"NASDAQ : {len(nasdaq)}")

import yfinance as yf
import pandas as pd

# ฟังก์ชันเพื่อดึงข้อมูลหุ้น
def get_stock_data(ticker, index_name):
    try:
        stock = yf.Ticker(ticker)

    # ดึงข้อมูลที่ต้องการ
        company_name = stock.info.get("longName", "N/A")
        pe_ratio = stock.info.get("trailingPE", "N/A")
        eps = stock.info.get("trailingEps", "N/A")
        eps_growth = stock.info.get("forwardPE", "N/A")
        roe = stock.info.get("returnOnEquity", "N/A")
        dividend_yield = stock.info.get("dividendYield", "N/A")
        avg_dividend_yield_5y = stock.info.get("fiveYearAvgDividendYield", "N/A")
        market_cap = stock.info.get("marketCap", "N/A")
        debt_to_equity = stock.info.get("debtToEquity", "N/A")
        beta = stock.info.get("beta", "N/A")
        volatility = stock.history(period="5y")["Close"].pct_change().std()

        history_1y = stock.history(period="1y")["Close"]
        history_2y = stock.history(period="2y")["Close"]
        history_5y = stock.history(period="5y")["Close"]

        performance_1y = (history_1y.iloc[-1] - history_1y.iloc[0]) / history_1y.iloc[0]
        performance_2y = (history_2y.iloc[-1] - history_2y.iloc[0]) / history_2y.iloc[0] 
        performance_5y = (history_5y.iloc[-1] - history_5y.iloc[0]) / history_5y.iloc[0] 

        return {
            "Index": index_name,
            "Company": company_name,
            "Symbol": ticker,
            "PE Ratio": pe_ratio,
            "EPS": eps,
            "EPS Growth (%)": eps_growth,
            "ROE (%)": roe,
            "Dividend Yield (%)": dividend_yield,
            "5 Year Average Dividend Yield (%)": avg_dividend_yield_5y,
            "Performance 1Y (%)": performance_1y,
            "Performance 2Y (%)": performance_2y,
            "Performance 5Y (%)": performance_5y,
            "Market Capitalization": market_cap,
            "Debt-to-Equity Ratio": debt_to_equity,
            "Beta": beta,
            "Volatility 5Y (%)": volatility
        }
    except Exception as e:
        print(f"An unexpected error occurred: {e}")

stock_data = []

for stock_index in all_stock_index:
    for index_name, stocks in stock_index.items():
        for stock in stocks:
            data = get_stock_data(stock, index_name)
            stock_data.append(data)

df = pd.DataFrame(stock_data)
df.to_excel("new_stock_data.xlsx", index=False)




